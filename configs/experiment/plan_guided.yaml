# @package _global_

global_cfg: # would be passed to actor, critic1, critic2, policy, env
  null

runner:
  _target_: src.runner.PlanGuidedRunner
  _partial_: true

diffusion_dir: 'logs/pretrained/maze2d-large-v1/diffusion/H384_T256' # ! load trained diffusion model from here
epoch: 'latest'
# TODO make a separate config for diffusion model
# diffusion_experiment:
#   _target_: diffuser.utils.load_diffusion
#   _args_:
#     - 'logs/pretrained/maze2d-large-v1/diffusion/H384_T256' # ! load trained diffusion model from here
#   epoch: 'latest'
#   seed: ${seed}
#   device: ${device}

guide:
  _target_: diffuser.sampling.NoTrainGuideShort

policy:
  _target_: diffuser.sampling.GuidedPolicy
  _partial_: true
  scale: 0.1
  preprocess_fns: []
  sample_fn: 
    _target_: diffuser.sampling.n_step_guided_p_sample
    _partial_: true
  n_guide_steps: 2
  t_stopgrad: 2
  scale_grad_by_std: true

trainer:
  max_episode_length: 1000
  batch_size: 10
  verbose: true


vis_freq: 10
max_render: 10


# common - for all tasks (task_name, tags, output_dir, device)
algorithm_name: "DefaultAlgName"
task_name: "RL_Diffuser"
tags: ["debug"]